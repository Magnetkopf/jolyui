{
  "name": "lazy-video",
  "type": "registry:ui",
  "files": [
    {
      "path": "ui/lazy-video.tsx",
      "content": "\"use client\";\n\nimport type React from \"react\";\nimport { useEffect, useRef, useState } from \"react\";\n\nexport interface LazyVideoProps\n  extends React.VideoHTMLAttributes<HTMLVideoElement> {\n  src: string;\n  fallback?: string;\n  threshold?: number;\n  rootMargin?: string;\n}\n\nexport function LazyVideo({\n  src,\n  className = \"\",\n  poster,\n  autoPlay = false,\n  loop = false,\n  muted = true,\n  controls = false,\n  playsInline = true,\n  \"aria-label\": ariaLabel,\n  ...props\n}: LazyVideoProps) {\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n  const [loaded, setLoaded] = useState(false);\n\n  useEffect(() => {\n    const el = videoRef.current;\n    if (!el) return;\n\n    const prefersReducedMotion =\n      window.matchMedia?.(\"(prefers-reduced-motion: reduce)\")?.matches ?? false;\n    const saveData = (navigator as any)?.connection?.saveData === true;\n    const shouldAutoplay = autoPlay && !prefersReducedMotion && !saveData;\n\n    let observer: IntersectionObserver | null = null;\n\n    const onIntersect: IntersectionObserverCallback = (entries) => {\n      entries.forEach(async (entry) => {\n        if (entry.isIntersecting && !loaded) {\n          el.src = src;\n          el.load();\n\n          if (shouldAutoplay) {\n            const playVideo = async () => {\n              try {\n                await el.play();\n              } catch (error) {\n                // Autoplay might be blocked\n                // console.log(\"[v0] Autoplay blocked:\", error)\n              }\n            };\n            if (el.readyState >= 3) {\n              playVideo();\n            } else {\n              el.addEventListener(\"canplay\", playVideo, { once: true });\n            }\n          }\n\n          setLoaded(true);\n        } else if (!entry.isIntersecting && loaded && shouldAutoplay) {\n          try {\n            el.pause();\n          } catch {}\n        } else if (entry.isIntersecting && loaded && shouldAutoplay) {\n          try {\n            await el.play();\n          } catch {}\n        }\n      });\n    };\n\n    observer = new IntersectionObserver(onIntersect, {\n      rootMargin: \"80px\",\n      threshold: 0.15,\n    });\n    observer.observe(el);\n\n    const onVisibility = () => {\n      if (!el) return;\n      const hidden = document.visibilityState === \"hidden\";\n      if (hidden) {\n        try {\n          el.pause();\n        } catch {}\n      } else if (shouldAutoplay && loaded) {\n        // resume only if we were auto-playing\n        el.play().catch(() => {});\n      }\n    };\n    document.addEventListener(\"visibilitychange\", onVisibility);\n\n    return () => {\n      document.removeEventListener(\"visibilitychange\", onVisibility);\n      observer?.disconnect();\n    };\n  }, [src, loaded, autoPlay]);\n\n  return (\n    <video\n      ref={videoRef}\n      className={className}\n      muted={muted}\n      loop={loop}\n      playsInline={playsInline}\n      controls={controls}\n      preload=\"none\"\n      poster={poster}\n      aria-label={ariaLabel}\n      disableRemotePlayback\n      {...props}\n    >\n      Your browser does not support the video tag.\n    </video>\n  );\n}\n",
      "type": "registry:ui",
      "target": ""
    }
  ]
}