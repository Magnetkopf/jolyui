{
  "name": "file-tree",
  "type": "registry:ui",
  "dependencies": [
    "lucide-react",
    "motion"
  ],
  "files": [
    {
      "path": "ui/file-tree.tsx",
      "content": "import { ChevronRight, File, Folder, FolderOpen } from \"lucide-react\";\nimport { AnimatePresence, motion } from \"motion/react\";\nimport * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nexport interface TreeNode {\n  id: string;\n  name: string;\n  type: \"file\" | \"folder\";\n  children?: TreeNode[];\n  icon?: React.ReactNode;\n}\n\ninterface FileTreeContextValue {\n  selectedId: string | null;\n  setSelectedId: (id: string | null) => void;\n  expandedIds: Set<string>;\n  toggleExpanded: (id: string) => void;\n}\n\nconst FileTreeContext = React.createContext<FileTreeContextValue | null>(null);\n\nfunction useFileTree() {\n  const context = React.useContext(FileTreeContext);\n  if (!context) {\n    throw new Error(\"useFileTree must be used within a FileTree\");\n  }\n  return context;\n}\n\nfunction getAllFolderIds(nodes: TreeNode[]): string[] {\n  const ids: string[] = [];\n  for (const node of nodes) {\n    if (node.type === \"folder\") {\n      ids.push(node.id);\n      if (node.children) {\n        ids.push(...getAllFolderIds(node.children));\n      }\n    }\n  }\n  return ids;\n}\n\ninterface FileTreeProps {\n  data: TreeNode[];\n  className?: string;\n  defaultExpandedIds?: string[];\n  expandAllByDefault?: boolean;\n  onSelect?: (node: TreeNode) => void;\n}\n\nexport function FileTree({\n  data,\n  className,\n  defaultExpandedIds = [],\n  expandAllByDefault = false,\n  onSelect,\n}: FileTreeProps) {\n  const [selectedId, setSelectedId] = React.useState<string | null>(null);\n  const [expandedIds, setExpandedIds] = React.useState<Set<string>>(\n    new Set(expandAllByDefault ? getAllFolderIds(data) : defaultExpandedIds),\n  );\n\n  const toggleExpanded = React.useCallback((id: string) => {\n    setExpandedIds((prev) => {\n      const next = new Set(prev);\n      if (next.has(id)) {\n        next.delete(id);\n      } else {\n        next.add(id);\n      }\n      return next;\n    });\n  }, []);\n\n  const handleSelect = React.useCallback(\n    (node: TreeNode) => {\n      setSelectedId(node.id);\n      onSelect?.(node);\n    },\n    [onSelect],\n  );\n\n  return (\n    <FileTreeContext.Provider\n      value={{\n        selectedId,\n        setSelectedId: (id) => setSelectedId(id),\n        expandedIds,\n        toggleExpanded,\n      }}\n    >\n      <div\n        className={cn(\n          \"rounded-lg border border-border bg-card p-2 font-mono text-sm\",\n          className,\n        )}\n        role=\"tree\"\n        aria-label=\"File tree\"\n      >\n        <TreeNodeList nodes={data} level={0} onSelect={handleSelect} />\n      </div>\n    </FileTreeContext.Provider>\n  );\n}\n\ninterface TreeNodeListProps {\n  nodes: TreeNode[];\n  level: number;\n  onSelect: (node: TreeNode) => void;\n}\n\nfunction TreeNodeList({ nodes, level, onSelect }: TreeNodeListProps) {\n  return (\n    <ul className=\"space-y-0.5\" role=\"group\">\n      {nodes.map((node, index) => (\n        <TreeNodeItem\n          key={node.id}\n          node={node}\n          level={level}\n          onSelect={onSelect}\n          isLast={index === nodes.length - 1}\n        />\n      ))}\n    </ul>\n  );\n}\n\ninterface TreeNodeItemProps {\n  node: TreeNode;\n  level: number;\n  onSelect: (node: TreeNode) => void;\n  isLast: boolean;\n}\n\nfunction TreeNodeItem({ node, level, onSelect, isLast }: TreeNodeItemProps) {\n  const { selectedId, expandedIds, toggleExpanded } = useFileTree();\n  const isExpanded = expandedIds.has(node.id);\n  const isSelected = selectedId === node.id;\n  const hasChildren =\n    node.type === \"folder\" && node.children && node.children.length > 0;\n\n  const handleClick = () => {\n    if (node.type === \"folder\") {\n      toggleExpanded(node.id);\n    }\n    onSelect(node);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" || e.key === \" \") {\n      e.preventDefault();\n      handleClick();\n    }\n    if (e.key === \"ArrowRight\" && node.type === \"folder\" && !isExpanded) {\n      e.preventDefault();\n      toggleExpanded(node.id);\n    }\n    if (e.key === \"ArrowLeft\" && node.type === \"folder\" && isExpanded) {\n      e.preventDefault();\n      toggleExpanded(node.id);\n    }\n  };\n\n  const getFileIcon = () => {\n    if (node.icon) return node.icon;\n    if (node.type === \"folder\") {\n      return isExpanded ? (\n        <FolderOpen className=\"h-4 w-4 text-tree-folder\" />\n      ) : (\n        <Folder className=\"h-4 w-4 text-tree-folder\" />\n      );\n    }\n    return <File className=\"h-4 w-4 text-tree-file\" />;\n  };\n\n  return (\n    <li\n      role=\"treeitem\"\n      aria-expanded={node.type === \"folder\" ? isExpanded : undefined}\n    >\n      <motion.div\n        className={cn(\n          \"group relative flex cursor-pointer select-none items-center gap-1 rounded-md px-2 py-1.5 transition-colors\",\n          isSelected\n            ? \"bg-tree-selected-bg text-foreground\"\n            : \"text-muted-foreground hover:bg-tree-hover hover:text-foreground\",\n        )}\n        onClick={handleClick}\n        onKeyDown={handleKeyDown}\n        tabIndex={0}\n        style={{ paddingLeft: `${level * 12 + 8}px` }}\n        whileTap={{ scale: 0.98 }}\n        layout\n      >\n        {/* Indent lines */}\n        {level > 0 && (\n          <div\n            className=\"absolute top-0 left-0 h-full\"\n            style={{ width: `${level * 12}px` }}\n          >\n            {Array.from({ length: level }).map((_, i) => (\n              <div\n                key={i}\n                className=\"absolute top-0 h-full w-px bg-tree-line opacity-30\"\n                style={{ left: `${i * 12 + 12}px` }}\n              />\n            ))}\n          </div>\n        )}\n\n        {/* Chevron for folders */}\n        {node.type === \"folder\" ? (\n          <motion.div\n            animate={{ rotate: isExpanded ? 90 : 0 }}\n            transition={{ duration: 0.15, ease: \"easeOut\" }}\n            className=\"flex h-4 w-4 shrink-0 items-center justify-center\"\n          >\n            <ChevronRight className=\"h-3.5 w-3.5 text-muted-foreground\" />\n          </motion.div>\n        ) : (\n          <div className=\"h-4 w-4 shrink-0\" />\n        )}\n\n        {/* Icon */}\n        <motion.div\n          className=\"shrink-0\"\n          initial={false}\n          animate={{ scale: isSelected ? 1.1 : 1 }}\n          transition={{ duration: 0.15 }}\n        >\n          {getFileIcon()}\n        </motion.div>\n\n        {/* Name */}\n        <span className=\"truncate text-[13px]\">{node.name}</span>\n\n        {/* Selection indicator */}\n        {isSelected && (\n          <motion.div\n            className=\"absolute inset-y-0 left-0 w-0.5 rounded-full bg-tree-selected\"\n            layoutId=\"selection-indicator\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          />\n        )}\n      </motion.div>\n\n      {/* Children */}\n      <AnimatePresence initial={false}>\n        {hasChildren && isExpanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: \"auto\", opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{\n              height: { duration: 0.2, ease: [0.4, 0, 0.2, 1] },\n              opacity: { duration: 0.15, ease: \"easeOut\" },\n            }}\n            style={{ overflow: \"hidden\" }}\n          >\n            <TreeNodeList\n              nodes={node.children!}\n              level={level + 1}\n              onSelect={onSelect}\n            />\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </li>\n  );\n}\n\nexport { FileTreeContext, useFileTree };\n",
      "type": "registry:ui",
      "target": ""
    }
  ]
}